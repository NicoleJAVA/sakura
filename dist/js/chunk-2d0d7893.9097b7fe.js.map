{"version":3,"sources":["webpack:///./src/views/UserCart.vue","webpack:///./src/views/UserCart.vue?159a"],"names":["class","style","colspan","href","role","active","isLoading","cart","carts","item","key","id","type","disabled","status","loadingItem","removeCartItem","product","title","coupon","updateCart","min","qty","unit","final_total","total","$filters","currency","coupon_code","placeholder","addCouponCode","goToForm","products","imageUrl","price","origin_price","getProduct","addToCart","data","inject","methods","api","this","$api","product_id","$http","put","then","response","isApiSuccess","getCart","catch","error","console","post","pushMessage","err","code","delete","getProducts","get","$router","push","created","render"],"mappings":"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","file":"js/chunk-2d0d7893.9097b7fe.js","sourcesContent":["<template>\n  <Loading :active=\"isLoading\"></Loading>\n  <div class=\"container\">\n    <div class=\"row mt-4\">\n      <div class=\"col-md-5\">\n        <div class=\"\">\n          <table class=\"table align-middle\">\n            <thead>\n              <tr>\n                <th></th>\n                <th>品名</th>\n                <th style=\"width: 150px\">數量</th>\n                <th>單價</th>\n              </tr>\n            </thead>\n            <tbody>\n              <template v-if=\"cart.carts\">\n                <tr v-for=\"item in cart.carts\" :key=\"item.id\">\n                  <td>\n                    <button\n                      type=\"button\"\n                      class=\"btn btn-outline-danger btn-sm\"\n                      :disabled=\"status.loadingItem === item.id\"\n                      @click=\"removeCartItem(item.id)\"\n                    >\n                      <i class=\"bi bi-x\"></i>\n                    </button>\n                  </td>\n                  <td>\n                    {{ item.product.title }}\n                    <div class=\"text-success\" v-if=\"item.coupon\">\n                      已套用優惠券\n                    </div>\n                  </td>\n                  <td>\n                    <div class=\"input-group input-group-sm\">\n                      <input\n                        type=\"number\"\n                        class=\"form-control\"\n                        :disabled=\"status.loadingItem === item.id\"\n                        @change=\"updateCart(item)\"\n                        min=\"1\"\n                        v-model.number=\"item.qty\"\n                      />\n                      <div class=\"input-group-text\">\n                        / {{ item.product.unit }}\n                      </div>\n                    </div>\n                  </td>\n                  <td class=\"text-end\">\n                    <small\n                      v-if=\"cart.final_total !== cart.total\"\n                      class=\"text-success\"\n                      >折扣價：</small\n                    >\n                    {{ $filters.currency(item.final_total) }}\n                  </td>\n                </tr>\n              </template>\n            </tbody>\n            <tfoot>\n              <tr>\n                <td colspan=\"3\" class=\"text-end\">總計</td>\n                <td class=\"text-end\">{{ $filters.currency(cart.total) }}</td>\n              </tr>\n              <tr v-if=\"cart.final_total !== cart.total\">\n                <td colspan=\"3\" class=\"text-end text-success\">折扣價</td>\n                <td class=\"text-end text-success\">\n                  {{ $filters.currency(cart.final_total) }}\n                </td>\n              </tr>\n            </tfoot>\n          </table>\n          <div class=\"input-group mb-3 input-group-sm\">\n            <input\n              type=\"text\"\n              class=\"form-control\"\n              v-model=\"coupon_code\"\n              placeholder=\"請輸入優惠碼\"\n            />\n            <div class=\"input-group-append\">\n              <button\n                class=\"btn btn-outline-secondary\"\n                type=\"button\"\n                @click=\"addCouponCode\"\n              >\n                套用優惠碼\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"\">\n      <div class=\"\">\n        <div class=\"btn btn-primary\" @click=\"goToForm\">前往結帳</div>\n      </div>\n    </div>\n\n    <div class=\"row\">\n      <div class=\"col-md-7\">\n        <table class=\"table align-middle\">\n          <thead>\n            <tr>\n              <th>圖片</th>\n              <th>商品名稱</th>\n              <th>價格</th>\n              <th></th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"item in products\" :key=\"item.id\">\n              <td style=\"width: 200px\">\n                <div\n                  style=\"height: 100px; background-size: cover; background-position: center\"\n                  :style=\"{ backgroundImage: `url(${item.imageUrl})` }\"\n                ></div>\n              </td>\n              <td>\n                <a href=\"#\" class=\"text-dark\">{{ item.title }}</a>\n              </td>\n              <td>\n                <div class=\"h5\" v-if=\"!item.price\">\n                  {{ item.origin_price }} 元\n                </div>\n                <del class=\"h6\" v-if=\"item.price\"\n                  >原價 {{ item.origin_price }} 元</del\n                >\n                <div class=\"h5\" v-if=\"item.price\">\n                  現在只要 {{ item.price }} 元\n                </div>\n              </td>\n              <td>\n                <div class=\"btn-group btn-group-sm\">\n                  <button\n                    type=\"button\"\n                    class=\"btn btn-outline-secondary\"\n                    @click=\"getProduct(item.id)\"\n                  >\n                    查看更多\n                  </button>\n                  <button\n                    type=\"button\"\n                    class=\"btn btn-outline-danger position-relative\"\n                    :disabled=\"status.loadingItem === item.id\"\n                    @click=\"addToCart(item.id)\"\n                  >\n                    <div :class=\"{ invisible: status.loadingItem === item.id }\">\n                      加到購物車\n                    </div>\n                    <div\n                      class=\"position-absolute w-100\"\n                      :class=\"{ invisible: status.loadingItem !== item.id }\"\n                      style=\"top: 50%; left: 50%; transform: translate(-50%, -50%);\"\n                    >\n                      <div\n                        class=\"spinner-border spinner-border-sm text-danger\"\n                        role=\"status\"\n                      ></div>\n                    </div>\n                  </button>\n                </div>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  data () {\n    return {\n      products: [],\n      product: {},\n      isLoading: false,\n      status: {\n        loadingItem: '',\n      },\n      cart: {},\n      coupon_code: '',\n    };\n  },\n  inject: ['pushMessage', 'isApiSuccess'],\n  methods: {\n    updateCart (item) {\n      const api = this.$api + `/cart/${item.id}`;\n      this.isLoading = true;\n      this.status.loadingItem = item.id;\n      const cart = {\n        product_id: item.product_id,\n        qty: item.qty,\n      };\n\n      this.$http\n        .put(api, { data: cart })\n        .then(response => {\n          this.isLoading = false;\n          this.status.loadingItem = '';\n\n          if (!this.isApiSuccess(response, api)) return;\n\n          this.getCart();\n        })\n        .catch(error => {\n          console.error('Failed to update cart. ', error);\n        });\n    },\n    addToCart (id) {\n      this.status.loadingItem = id;\n      const api = this.$api + '/cart';\n      const cart = {\n        product_id: id,\n        qty: 1,\n      };\n      this.$http\n        .post(api, { data: cart })\n        .then(response => {\n          this.pushMessage(response, '加入購物車');\n          this.status.loadingItem = '';\n          this.getCart();\n        })\n        .catch(err => {\n          console.error('Add to cart error: ', err);\n        });\n    },\n    addCouponCode () {\n      const api = this.$api + '/coupon';\n      const coupon = {\n        code: this.coupon_code,\n      };\n      this.isLoading = true;\n      this.$http.post(api, { data: coupon }).then(response => {\n        this.getCart();\n        this.pushMessage(response, '套用優惠券');\n        this.isLoading = false;\n      });\n    },\n    removeCartItem (id) {\n      const api = this.$api + '/cart/' + id;\n      this.status.loadingItem = id;\n      this.isLoading = true;\n      this.$http.delete(api).then(response => {\n        this.status.loadingItem = '';\n        this.isLoading = false;\n        this.getCart();\n        this.pushMessage(response, '刪除購物車品項');\n      });\n    },\n    getProducts () {\n      const api = this.$api + '/products/all';\n      this.isLoading = true;\n      this.$http.get(api).then(response => {\n        this.isLoading = false;\n        this.products = response.data.products;\n      });\n    },\n    getCart () {\n      const api = this.$api + '/cart';\n      this.isLoading = true;\n      this.$http\n        .get(api)\n        .then(response => {\n          this.isLoading = false;\n\n          if (!this.isApiSuccess(response, api)) return;\n\n          this.cart = response.data.data;\n        })\n        .catch(error => {\n          console.error('ERROR! Cannot get cart data: ', error);\n        });\n    },\n    getProduct (id) {\n      this.$router.push(`/user/product/${id}`);\n    },\n    goToForm () {\n      this.$router.push('/user/form');\n    },\n  },\n  created () {\n    this.getProducts();\n    this.getCart();\n  },\n};\n</script>\n","import { render } from \"./UserCart.vue?vue&type=template&id=6800b852\"\nimport script from \"./UserCart.vue?vue&type=script&lang=js\"\nexport * from \"./UserCart.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}