(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d7893"],{"76db":function(t,e,c){"use strict";c.r(e);var i=c("7a23"),n={class:"container"},s={class:"row mt-4"},a={class:"col-md-5"},o={class:""},u={class:"table align-middle"},l=Object(i["i"])("thead",null,[Object(i["i"])("tr",null,[Object(i["i"])("th"),Object(i["i"])("th",null,"品名"),Object(i["i"])("th",{style:{width:"150px"}},"數量"),Object(i["i"])("th",null,"單價")])],-1),d=Object(i["i"])("i",{class:"bi bi-x"},null,-1),r={key:0,class:"text-success"},b={class:"input-group input-group-sm"},j={class:"input-group-text"},p={class:"text-end"},O={key:0,class:"text-success"},h=Object(i["i"])("td",{colspan:"3",class:"text-end"},"總計",-1),g={class:"text-end"},f={key:0},m=Object(i["i"])("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),v={class:"text-end text-success"},y={class:"input-group mb-3 input-group-sm"},C={class:"input-group-append"},k={class:""},x={class:""},$={class:"row"},I={class:"col-md-7"},L={class:"table align-middle"},_=Object(i["i"])("thead",null,[Object(i["i"])("tr",null,[Object(i["i"])("th",null,"圖片"),Object(i["i"])("th",null,"商品名稱"),Object(i["i"])("th",null,"價格"),Object(i["i"])("th")])],-1),w={style:{width:"200px"}},G={href:"#",class:"text-dark"},P={key:0,class:"h5"},q={key:1,class:"h6"},T={key:2,class:"h5"},A={class:"btn-group btn-group-sm"},F=Object(i["i"])("div",{class:"spinner-border spinner-border-sm text-danger",role:"status"},null,-1);function M(t,e,c,M,U,R){var S=Object(i["D"])("Loading");return Object(i["u"])(),Object(i["e"])(i["a"],null,[Object(i["i"])(S,{active:U.isLoading},null,8,["active"]),Object(i["i"])("div",n,[Object(i["i"])("div",s,[Object(i["i"])("div",a,[Object(i["i"])("div",o,[Object(i["i"])("table",u,[l,Object(i["i"])("tbody",null,[U.cart.carts?(Object(i["u"])(!0),Object(i["e"])(i["a"],{key:0},Object(i["B"])(U.cart.carts,(function(e){return Object(i["u"])(),Object(i["e"])("tr",{key:e.id},[Object(i["i"])("td",null,[Object(i["i"])("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:U.status.loadingItem===e.id,onClick:function(t){return R.removeCartItem(e.id)}},[d],8,["disabled","onClick"])]),Object(i["i"])("td",null,[Object(i["h"])(Object(i["G"])(e.product.title)+" ",1),e.coupon?(Object(i["u"])(),Object(i["e"])("div",r," 已套用優惠券 ")):Object(i["f"])("",!0)]),Object(i["i"])("td",null,[Object(i["i"])("div",b,[Object(i["P"])(Object(i["i"])("input",{type:"number",class:"form-control",disabled:U.status.loadingItem===e.id,onChange:function(t){return R.updateCart(e)},min:"1","onUpdate:modelValue":function(t){return e.qty=t}},null,40,["disabled","onChange","onUpdate:modelValue"]),[[i["K"],e.qty,void 0,{number:!0}]]),Object(i["i"])("div",j," / "+Object(i["G"])(e.product.unit),1)])]),Object(i["i"])("td",p,[U.cart.final_total!==U.cart.total?(Object(i["u"])(),Object(i["e"])("small",O,"折扣價：")):Object(i["f"])("",!0),Object(i["h"])(" "+Object(i["G"])(t.$filters.currency(e.final_total)),1)])])})),128)):Object(i["f"])("",!0)]),Object(i["i"])("tfoot",null,[Object(i["i"])("tr",null,[h,Object(i["i"])("td",g,Object(i["G"])(t.$filters.currency(U.cart.total)),1)]),U.cart.final_total!==U.cart.total?(Object(i["u"])(),Object(i["e"])("tr",f,[m,Object(i["i"])("td",v,Object(i["G"])(t.$filters.currency(U.cart.final_total)),1)])):Object(i["f"])("",!0)])]),Object(i["i"])("div",y,[Object(i["P"])(Object(i["i"])("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=function(t){return U.coupon_code=t}),placeholder:"請輸入優惠碼"},null,512),[[i["K"],U.coupon_code]]),Object(i["i"])("div",C,[Object(i["i"])("button",{class:"btn btn-outline-secondary",type:"button",onClick:e[2]||(e[2]=function(){return R.addCouponCode&&R.addCouponCode.apply(R,arguments)})}," 套用優惠碼 ")])])])])]),Object(i["i"])("div",k,[Object(i["i"])("div",x,[Object(i["i"])("div",{class:"btn btn-primary",onClick:e[3]||(e[3]=function(){return R.goToForm&&R.goToForm.apply(R,arguments)})},"前往結帳")])]),Object(i["i"])("div",$,[Object(i["i"])("div",I,[Object(i["i"])("table",L,[_,Object(i["i"])("tbody",null,[(Object(i["u"])(!0),Object(i["e"])(i["a"],null,Object(i["B"])(U.products,(function(t){return Object(i["u"])(),Object(i["e"])("tr",{key:t.id},[Object(i["i"])("td",w,[Object(i["i"])("div",{style:[{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:"url(".concat(t.imageUrl,")")}]},null,4)]),Object(i["i"])("td",null,[Object(i["i"])("a",G,Object(i["G"])(t.title),1)]),Object(i["i"])("td",null,[t.price?Object(i["f"])("",!0):(Object(i["u"])(),Object(i["e"])("div",P,Object(i["G"])(t.origin_price)+" 元 ",1)),t.price?(Object(i["u"])(),Object(i["e"])("del",q,"原價 "+Object(i["G"])(t.origin_price)+" 元",1)):Object(i["f"])("",!0),t.price?(Object(i["u"])(),Object(i["e"])("div",T," 現在只要 "+Object(i["G"])(t.price)+" 元 ",1)):Object(i["f"])("",!0)]),Object(i["i"])("td",null,[Object(i["i"])("div",A,[Object(i["i"])("button",{type:"button",class:"btn btn-outline-secondary",onClick:function(e){return R.getProduct(t.id)}}," 查看更多 ",8,["onClick"]),Object(i["i"])("button",{type:"button",class:"btn btn-outline-danger position-relative",disabled:U.status.loadingItem===t.id,onClick:function(e){return R.addToCart(t.id)}},[Object(i["i"])("div",{class:{invisible:U.status.loadingItem===t.id}}," 加到購物車 ",2),Object(i["i"])("div",{class:["position-absolute w-100",{invisible:U.status.loadingItem!==t.id}],style:{top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},[F],2)],8,["disabled","onClick"])])])])})),128))])])])])])],64)}var U={data:function(){return{products:[],product:{},isLoading:!1,status:{loadingItem:""},cart:{},coupon_code:""}},inject:["pushMessage","isApiSuccess"],methods:{updateCart:function(t){var e=this,c=this.$api+"/cart/".concat(t.id);this.isLoading=!0,this.status.loadingItem=t.id;var i={product_id:t.product_id,qty:t.qty};this.$http.put(c,{data:i}).then((function(t){e.isLoading=!1,e.status.loadingItem="",e.isApiSuccess(t,c)&&e.getCart()})).catch((function(t){console.error("Failed to update cart. ",t)}))},addToCart:function(t){var e=this;this.status.loadingItem=t;var c=this.$api+"/cart",i={product_id:t,qty:1};this.$http.post(c,{data:i}).then((function(t){e.pushMessage(t,"加入購物車"),e.status.loadingItem="",e.getCart()})).catch((function(t){console.error("Add to cart error: ",t)}))},addCouponCode:function(){var t=this,e=this.$api+"/coupon",c={code:this.coupon_code};this.isLoading=!0,this.$http.post(e,{data:c}).then((function(e){t.getCart(),t.pushMessage(e,"套用優惠券"),t.isLoading=!1}))},removeCartItem:function(t){var e=this,c=this.$api+"/cart/"+t;this.status.loadingItem=t,this.isLoading=!0,this.$http.delete(c).then((function(t){e.status.loadingItem="",e.isLoading=!1,e.getCart(),e.pushMessage(t,"刪除購物車品項")}))},getProducts:function(){var t=this,e=this.$api+"/products/all";this.isLoading=!0,this.$http.get(e).then((function(e){t.isLoading=!1,t.products=e.data.products}))},getCart:function(){var t=this,e=this.$api+"/cart";this.isLoading=!0,this.$http.get(e).then((function(c){t.isLoading=!1,t.isApiSuccess(c,e)&&(t.cart=c.data.data)})).catch((function(t){console.error("ERROR! Cannot get cart data: ",t)}))},getProduct:function(t){this.$router.push("/user/product/".concat(t))},goToForm:function(){this.$router.push("/user/form")}},created:function(){this.getProducts(),this.getCart()}};U.render=M;e["default"]=U}}]);
//# sourceMappingURL=chunk-2d0d7893.9097b7fe.js.map